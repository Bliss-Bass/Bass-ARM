From cd6b9ce09c9f438fb5f8e298147c6f471e305e8c Mon Sep 17 00:00:00 2001
From: hmtheboy154 <buingoc67@gmail.com>
Date: Fri, 30 Dec 2022 00:45:28 +0700
Subject: [PATCH 4/4] Rename MICROG_SPOOF_SIGNATURE to FAKE_PACKAGE_SIGNATURE

To support the original microG instead of CalyxOS one

Change-Id: Id661ad232adcf26a474296e4cfce8ea061675960
---
 core/res/AndroidManifest.xml                                 | 2 +-
 services/core/java/com/android/server/pm/ComputerEngine.java | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/core/res/AndroidManifest.xml b/core/res/AndroidManifest.xml
index c68a5b4f107d..2bd2d10dea21 100644
--- a/core/res/AndroidManifest.xml
+++ b/core/res/AndroidManifest.xml
@@ -3566,7 +3566,7 @@
 
     <!-- @hide Allows an application to change the package signature as
          seen by applications. Only allowed to be used by microG.-->
-    <permission android:name="android.permission.MICROG_SPOOF_SIGNATURE"
+    <permission android:name="android.permission.FAKE_PACKAGE_SIGNATURE"
         android:protectionLevel="signature|privileged" />
 
     <!-- @deprecated No longer useful, see
diff --git a/services/core/java/com/android/server/pm/ComputerEngine.java b/services/core/java/com/android/server/pm/ComputerEngine.java
index 4883a1c5341d..63da5916bd9c 100644
--- a/services/core/java/com/android/server/pm/ComputerEngine.java
+++ b/services/core/java/com/android/server/pm/ComputerEngine.java
@@ -1613,7 +1613,7 @@ public class ComputerEngine implements Computer {
     private PackageInfo mayFakeSignature(AndroidPackage p, PackageInfo pi,
             Set<String> permissions) {
         try {
-            if (permissions.contains("android.permission.MICROG_SPOOF_SIGNATURE")) {
+            if (permissions.contains("android.permission.FAKE_PACKAGE_SIGNATURE")) {
                 if (DEBUG_PACKAGE_INFO) {
                     Log.v(TAG, "Spoofing signature for microG");
                 }
@@ -1623,7 +1623,7 @@ public class ComputerEngine implements Computer {
             }
         } catch (Throwable t) {
             // We should never die because of any failures, this is system code!
-            Log.w("PackageManagerService.MICROG_SPOOF_SIGNATURE", t);
+            Log.w("PackageManagerService.FAKE_PACKAGE_SIGNATURE", t);
         }
         return pi;
     }
-- 
2.34.1

